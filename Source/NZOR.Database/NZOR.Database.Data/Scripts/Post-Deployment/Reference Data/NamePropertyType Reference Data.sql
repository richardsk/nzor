PRINT 'Starting NamePropertyType Reference Data'

GO

SET NOCOUNT ON

DECLARE @NamePropertyType TABLE
	(
	NamePropertyTypeID UNIQUEIDENTIFIER NOT NULL, 
	
	NameClassID UNIQUEIDENTIFIER NOT NULL, 
	
	Name NVARCHAR(50) NOT NULL, 
	Type NVARCHAR(10) NULL, 
	MinOccurrences INT NULL, 
	MaxOccurrences INT NULL, 
	GoverningCode NVARCHAR(5) NULL
	)

INSERT INTO
	@NamePropertyType
VALUES 
	('006D86A8-08A5-4C1A-BC08-C07B0225E01B', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Authors', N'string', 0, null, NULL),
	('F496FBCC-8DA6-4CA1-9884-11BD9B5DF63B', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Basionym', N'string', 0, null, N'ICBN'),
	('6272B3D0-C91B-4FD4-A714-662B10FA6E68', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'BasionymAuthors', N'string', 0, null, NULL),
	('5CA0ED28-575A-4F1A-8ED5-A030C823280C', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'BlockedName', N'string', 0, null, NULL),
	('1F64E93C-7EE8-40D7-8681-52B56060D750', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Canonical', N'string', 1, 1, NULL),
	('6196CDC4-BACB-4172-8186-14BA494621A7', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'CombinationAuthors', N'string', 0, null, NULL),
	('5B301993-64EA-4DA9-83D8-B399B1280C21', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'CultivarNameGroup', N'string', 0, null, NULL),
	('9F03AB3C-3F89-4772-A83A-E77499234545', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Genus', N'string', 0, 1, NULL),
	('0D3D3496-A20E-4CAA-AF0D-98ED6E13F125', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'InfragenericEpithet', N'string', 0, 1, NULL),
	('8A7D0F79-B9E8-4CC1-8D85-C142D48D1916', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'InfraspecificEpithet', N'string', 0, 1, NULL),
	('CA93F46D-B474-4D5F-9AE2-F4F142FB85FB', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'LaterHomonymOf', N'string', 0, null, NULL),
	('4A344D40-7448-49D6-956B-4392B33A749F', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'MicroReference', N'string', 0, null, NULL),
	('65F94532-7687-4958-B5B8-71F54866BEAD', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'NomenclaturalStatus', N'string', 0, null, NULL),
	('98606514-CC85-4E42-9EF4-9E594ECA03A8', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Orthography', N'string', 0, null, NULL),
	('DEDC63F0-FB2A-420B-9932-786B4347DA45', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'PublishedIn', N'string', 0, null, NULL),
	('6C98DA78-903D-4A2D-98E2-F9E23029EE28', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'QualityCode', N'string', 0, null, NULL),
	('A1D57520-3D64-4F7D-97C8-69B449AFA280', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Rank', N'string', 1, 1, NULL),
	('3886BD29-C987-411E-A2B5-BBD4708D7D1D', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'RecombinedName', N'string', 0, null, NULL),
	('5AC2A383-A4A3-401B-A99E-217BFC78AD19', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'SpecificEpithet', N'string', 0, 1, NULL),
	('9F581431-E2F4-4820-8807-087D6498EF1E', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'TypeName', N'string', 0, 1, NULL),
	('3E92C97D-9E5E-45CB-BAE8-CC553126AC24', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Uninomial', N'string', 0, 1, NULL),
	('C9E19D58-BD92-4F3C-96E8-DE7FA6DCD5F7', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'Year', N'string', 0, null, NULL),
	('4EC79307-E41A-4540-8647-03EF48795435', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'YearOnPublication', N'string', 1, null, NULL),
	('86E7590B-EF34-4E19-970B-608703B858A5', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'NameText_FullName', N'string', null, null, null),
	('86B84828-E1C0-45BD-A5C0-7B272EDC97EF', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'NameText_FullNameFormatted', N'string', null, null, null),
	('00806321-C8BD-4518-9539-1286DA02CA7D', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'NameText_PartialName', N'string', null, null, null),
	('F721F463-5F16-4333-9C7D-DDF848F2D1A9', 'A5233111-61A0-4AE6-9C2B-5E8E71F1473A', N'NameText_PartialNameFormatted', N'string', null, null, null),

	('C57F037C-1F1B-4E20-9557-A2D9161C1118', '05BCC19C-27E8-492C-8ADD-EC5F73325BC5', N'Country', N'string', 0, NULL, NULL),
	('44F50B86-5A11-4582-81C2-E03B7DF069EF', '05BCC19C-27E8-492C-8ADD-EC5F73325BC5', N'Language', N'string', 0, NULL, NULL),
	('51CBC9F9-4B26-4B09-8BAB-BAF3DA9F4FB3', '05BCC19C-27E8-492C-8ADD-EC5F73325BC5', N'PublishedIn', N'string', 0, 1, NULL),
	('88020F95-1282-4D9A-819A-0973F7F50284', '05BCC19C-27E8-492C-8ADD-EC5F73325BC5', N'NameText_FullName', N'string', null, null, null),

	('5F3CD05D-3BCC-4D2B-BE71-BFAC7DF9FD17', '3D3A13B8-C673-459C-B98D-8A5B08E3CA44', N'Country', N'string', 0, NULL, NULL),
	('2089E79F-4CD4-4CD7-AA0D-A3AD0CDFD331', '3D3A13B8-C673-459C-B98D-8A5B08E3CA44', N'Language', N'string', 0, NULL, NULL),
	('6D64E967-65EB-4533-8C40-1ED909407D59', '3D3A13B8-C673-459C-B98D-8A5B08E3CA44', N'PublishedIn', N'string', 0, 1, NULL),
	('C4954CF2-6A07-469B-B470-2D56E60C6666', '3D3A13B8-C673-459C-B98D-8A5B08E3CA44', N'NameText_FullName', N'string', null, null, null)

MERGE 
    dbo.NamePropertyType AS Target
USING 
    @NamePropertyType AS Source 
ON 
    (Target.NamePropertyTypeID = Source.NamePropertyTypeID)
WHEN MATCHED 
    THEN UPDATE
        SET   
			Target.NameClassID = Source.NameClassID,

            Target.Name = Source.Name,
            Target.Type = Source.Type,
            Target.MinOccurrences = Source.MinOccurrences,
            Target.MaxOccurrences = Source.MaxOccurrences,
            Target.GoverningCode = Source.GoverningCode

WHEN NOT MATCHED BY TARGET 
    THEN INSERT      
        (NamePropertyTypeID, NameClassID, Name, Type, MinOccurrences, MaxOccurrences, GoverningCode)
    VALUES      
        (NamePropertyTypeID, NameClassID, Name, Type, MinOccurrences, MaxOccurrences, GoverningCode)

WHEN NOT MATCHED BY SOURCE 
    THEN DELETE
; 

GO

PRINT 'Finished NamePropertyType Reference Data'

GO